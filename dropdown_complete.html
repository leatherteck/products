<div id="custom-code-8cMx13N4O4" class="custom-code-container ccustom-code-8cMx13N4O4">





    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>leather upholstery repair San Bernardino</title>

     <!-- Add Font Awesome for icon -->

     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer">

<style>

body {
    font-family: sans-serif;
    background-color: #000000;
 /* Dark background */
    color: #eee;
 /* Light text */
    padding: 0;
    margin: 0;
    overflow-x: hidden;
 /* Prevent accidental horizontal scrollbars */
}

h1, h2 {
    margin-bottom: 30px;
    margin-top: 20px;
 /* Add some top margin */
}



        /* --- Progress Bar Styles (Unchanged) --- */

#progressBarContainer {
    width: 90%;
    max-width: 600px;
    margin: 20px auto 35px auto;
    background-color: #333;
    border-radius: 25px;
    height: 25px;
    position: relative;
    overflow: hidden;
    border: 1px solid #444;
}

#progressBar {
    height: 100%;
    width: 0%;
    background-color: red;
    border-radius: 25px;
    transition: width 0.4s ease-in-out;
    text-align: center;
    color: black;
    line-height: 25px;
    font-weight: bold;
    font-size: 0.9em;
    overflow: hidden;
    white-space: nowrap;
}

#progressText {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    height: 100%;
    line-height: 25px;
    color: #ffffff;
    font-weight: bold;
    font-size: 0.9em;
    white-space: nowrap;
    z-index: 1;
    mix-blend-mode: difference;
}



        /* --- Dropdown Selection Container --- REFINED FOR HORIZONTAL LAYOUT & MOBILE --- */

#selectionContainer {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
    gap: 15px;
 /* Adjusted gap */
    margin-bottom: 30px;
    max-width: 950px;
    padding: 0 10px;
    margin-left: auto;
    margin-right: auto;
    transition: opacity 0.3s ease, visibility 0.3s ease, height 0.3s ease;
}

#selectionContainer > div {
    flex: 1 1 calc(25% - 15px);
 /* Target 4 columns, adjust for gap */
    min-width: 170px;
    text-align: center;
    margin-bottom: 10px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: bold;
    color: #eee;
    font-size: 0.9em;
}

#selectionContainer label {
    display: none;
}

#trimHeading {
    text-align: center;
    margin: 25px auto 15px;
    font-size: 1.2em;
    color: #fff;
    font-weight: 600;
    letter-spacing: 0.5px;
}

select {
    width: 100%;
    padding: 10px;
    margin-bottom: 0;
    border: 1px solid red;
    border-radius: 5px;
    background-color: #333;
    color: #eee;
    cursor: pointer;
    box-sizing: border-box;
    -webkit-appearance: none;
    appearance: none;
    background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23DDDDDD%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.4-12.8z%22/%3E%3C/svg%3E');
    background-repeat: no-repeat;
    background-position: right .7em top 50%;
    background-size: .65em auto;
    padding-right: 2.5em;
}

select:focus {
    border-color: #ff4444;
    outline: none;
    box-shadow: 0 0 5px rgba(255, 0, 0, 0.5);
}

select option {
    background-color: #333;
    color: #eee;
    padding: 5px;
}

select option[value=""], select option[value="default"] {
    color: #999;
}



        /* --- Button Styles --- MODIFIED --- */

#primaryActionButtonsContainer {
    text-align: center;
    width: 100%;
    margin-top: 20px;
    transition: opacity 0.3s ease, visibility 0.3s ease, height 0.3s ease;
}

button {
    padding: 12px 25px;
    cursor: pointer;
    border: none;
    border-radius: 5px;
    font-weight: bold;
    margin: 5px;
    transition: background-color 0.2s ease, opacity 0.3s ease, visibility 0.3s ease, height 0.3s ease, padding 0.3s ease, margin 0.3s ease, border 0.3s ease;
}

button:hover:not(:disabled) {
    opacity: 0.9;
}

button:disabled {
    background-color: #777 !important;
    cursor: not-allowed;
    color: #ccc !important;
}

button#nextButton {
    background-color: red;
    color: white;
}

button#nextButton:not(.hidden) {
    visibility: visible;
    opacity: 1;
    height: auto;
    margin-top: 5px;
    margin-bottom: 5px;
    padding: 12px 25px;
    border: none;
}

button#nextButton:hover:not(:disabled):not(.hidden) {
    background-color: #cc0000;
}



        /* Product Action Buttons */

#productActionButtons {
    text-align: center;
    margin: 25px auto;
    display: flex;
    flex-direction: column;
    gap: 18px;
    align-items: center;
    padding: 25px;
    background: rgba(255, 255, 255, 0.02);
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    max-width: 400px;
    width: 100%;
}

#productActionButtons .action-btn {
    width: 100% !important;
    max-width: 320px !important;
    min-width: 320px !important;
    margin: 0 !important;
    box-sizing: border-box !important;
}

.action-btn {
    padding: 16px 25px !important;
    border: none !important;
    border-radius: 10px !important;
    font-weight: 600 !important;
    font-size: 1.1em !important;
    cursor: pointer !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    text-align: center !important;
    display: block !important;
}

button.action-btn.primary-action {
    background: linear-gradient(135deg, #dc3545, #c82333) !important;
    border: none !important;
    color: white !important;
    font-size: 1.2em !important;
    font-weight: 700 !important;
    padding: 18px 35px !important;
    min-width: 320px !important;
    box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3) !important;
    position: relative !important;
    overflow: hidden !important;
    border-radius: 12px !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    cursor: pointer !important;
    animation: pulseGlow 2s ease-in-out infinite alternate !important;
}

@keyframes pulseGlow {

    0% {
        box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
    }

    100% {
        box-shadow: 0 4px 20px rgba(220, 53, 69, 0.5);
    }
}

button.action-btn.primary-action::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

button.action-btn.primary-action:active::after {
    width: 300px;
    height: 300px;
}

.action-btn.primary-action::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s;
}

.action-btn.primary-action:hover::before {
    left: 100%;
}

button.action-btn.primary-action:hover {
    background: linear-gradient(135deg, #e12e3d, #d21e2e) !important;
    transform: translateY(-3px) scale(1.02) !important;
    box-shadow: 0 12px 35px rgba(220, 53, 69, 0.5) !important;
    opacity: 1 !important;
}

button.action-btn.request-installation {
    background: linear-gradient(135deg, #6c757d, #5a6268) !important;
    border: none !important;
    color: white !important;
    font-weight: 600 !important;
    box-shadow: 0 2px 8px rgba(108, 117, 125, 0.2) !important;
    border-radius: 10px !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    position: relative !important;
    overflow: hidden !important;
}

button.action-btn.request-installation:hover {
    background: linear-gradient(135deg, #7a8288, #656c73) !important;
    transform: translateY(-2px) scale(1.01) !important;
    box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4) !important;
    opacity: 1 !important;
}

button.action-btn.get-consultation {
    background: linear-gradient(135deg, #7a8288, #656c73) !important;
    border: none !important;
    color: white !important;
    font-weight: 600 !important;
    box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2) !important;
    border-radius: 10px !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    position: relative !important;
    overflow: hidden !important;
}

button.action-btn.get-consultation:hover {
    background: linear-gradient(135deg, #32b54a, #218838) !important;
    transform: translateY(-2px) scale(1.01) !important;
    box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4) !important;
    opacity: 1 !important;
}

@media (max-width: 768px) {

    #productActionButtons {
        max-width: 350px;
        padding: 20px;
        gap: 15px;
    }

    #productActionButtons .action-btn {
        min-width: 280px !important;
        max-width: 280px !important;
        padding: 14px 20px !important;
        font-size: 1em !important;
    }

    button.action-btn.primary-action {
        min-width: 280px !important;
        padding: 16px 25px !important;
    }

    #postSelectionButtonsContainer {
        max-width: 350px;
        padding: 0 20px;
    }

    #postSelectionButtonsContainer button {
        max-width: 280px;
    }

    button#goBackButton {
        padding: 10px 16px !important;
        font-size: 0.85em !important;
    }
}

#postSelectionButtonsContainer {
    text-align: center;
    margin: 30px auto;
    transition: opacity 0.3s ease, visibility 0.3s ease, height 0.3s ease;
    max-width: 400px;
    width: 100%;
    padding: 0 25px;
    box-sizing: border-box;
}

#postSelectionButtonsContainer button {
    width: auto;
    max-width: 200px;
    margin: 0 auto;
    display: block;
}

button#goBackButton {
    background: linear-gradient(135deg, #6c757d, #5a6268) !important;
    color: white !important;
    padding: 10px 20px !important;
    border: none !important;
    border-radius: 8px !important;
    font-weight: 500 !important;
    font-size: 0.9em !important;
    text-transform: uppercase !important;
    letter-spacing: 0.5px !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    cursor: pointer !important;
    box-shadow: 0 2px 8px rgba(108, 117, 125, 0.2) !important;
}

button#goBackButton:hover:not(:disabled) {
    background: linear-gradient(135deg, #7a8288, #656c73) !important;
    transform: translateY(-2px) scale(1.01) !important;
    box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4) !important;
}

button#contactUsButton {
    background-color: red;
    color: white;
} /* This is the original one for image grid */

button#contactUsButton i {
    margin-right: 8px;
}

button#contactUsButton:hover:not(:disabled) {
    background-color: #cc0000;
}





        /* --- Contact Form Styles --- MODIFIED --- */

#contactFormContainer {
    position: relative;
    background: linear-gradient(145deg, #2a2a2a, #3a3a3a);
    border: 1px solid #dc3545;
    border-radius: 12px;
    padding: 30px;
    margin: 35px auto 0 auto;
    max-width: 700px;
    color: #eee;
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    overflow: hidden;
    opacity: 0;
    visibility: hidden;
    max-height: 0;
    transform: translateY(30px) scale(0.95);
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
}

#contactFormContainer.visible {
    opacity: 1;
    visibility: visible;
    max-height: 1500px;
    transform: translateY(0) scale(1);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
}

.form-close-button {
 /* NEW */
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 30px;
    font-weight: bold;
    color: #aaa;
    cursor: pointer;
    line-height: 1;
    padding: 5px;
    z-index: 10;
 /* Ensure it's above other form content */

        }

        .form-close-button:hover {

            color: #fff;

        }

        #contactFormContainer h2 { color: red; text-align: center; margin-bottom: 20px; }

        #selectedCarDetails { background-color: #2a2a2a; padding: 15px; border-radius: 5px; margin-bottom: 25px; border: 1px solid #444; }

        #selectedCarDetails h3 { margin-top: 0; margin-bottom: 15px; color: #f0f0f0; font-size: 1.1em; border-bottom: 1px solid red; padding-bottom: 5px; }

        #selectedCarDetails label { color: #bbb; font-size: 0.85em; margin-bottom: 3px; }

        #selectedCarDetails input[type="text"] { background-color: #444; color: #ddd; border: 1px solid #555; cursor: not-allowed; margin-bottom: 10px; width: 95%; padding: 8px; border-radius: 4px; box-sizing: border-box; }

        #contactForm label { display: block; margin-bottom: 5px; font-weight: bold; color: #eee; }

        #contactForm input[type="text"], #contactForm input[type="tel"], #contactForm input[type="email"], #contactForm textarea {
            width: 95%;
            padding: 12px 15px;
            margin-bottom: 20px;
            background-color: #1a1a1a;
            color: #eee;
            border: 2px solid #404040;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1em;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateY(0);
        }

        #contactForm textarea { min-height: 80px; resize: vertical; }

        #contactForm input:focus, #contactForm textarea:focus {
            border-color: #dc3545;
            outline: none;
            box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2);
            transform: translateY(-2px);
            background-color: #252525;
        }

        .terms-container { margin-bottom: 15px; }

        .terms-container input[type="checkbox"] { vertical-align: middle; margin-right: 5px; }

        .terms-container label { display: inline; font-size: 0.9em; }

        .terms-container a { color: #ff8080; text-decoration: underline; }

        .terms-container a:hover { color: #ff4444; }

        #termsError { color: orange; font-size: 0.8em; margin-top: 5px; display: none; width: 100%; }

        .form-buttons { text-align: center; margin-top: 20px; }

        #contactFormContainer button#submitButton { background-color: red; color: white; }

        #contactFormContainer button#submitButton:hover:not(:disabled) { background-color: #cc0000; }



        /* --- Target Element #section-rQpvwWrmJ7 (Unchanged) --- */

         #section-rQpvwWrmJ7 { background-color: #000000; padding: 20px; border-radius: 5px; border: 1px dashed red; margin: 20px auto; width: 95%; text-align: center; transition: opacity 0.3s ease, visibility 0.3s ease, height 0.3s ease; }



        /* --- Modified .hidden Class (KEEP) --- */

        .hidden {

            visibility: hidden !important; opacity: 0 !important; height: 0 !important; margin-top: 0 !important; margin-bottom: 0 !important; padding-top: 0 !important; padding-bottom: 0 !important; border-width: 0 !important; overflow: hidden !important; line-height: 0 !important; font-size: 0 !important;

        }

        .hidden select {

            height: 0 !important; padding: 0 !important; margin: 0 !important; border: 0 !important; display: block;

        }

        #primaryActionButtonsContainer.hidden-container { /* For the container itself */

             visibility: hidden !important; opacity: 0 !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: 0 !important; overflow: hidden !important;

        }





        /* --- Image Grid - Base 4 Columns --- */

        #image-container {

            display: grid;

            grid-template-columns: repeat(4, 1fr);

            gap: 10px;

            width: 95%;

            max-width: 1400px;

            margin: 20px auto;

            padding: 0;

            background-color: black;

            border-radius: 5px;

        }



        /* --- Grid Item / Image Styles --- */

        .grid-item {
            background-color: #000000;
            padding: 0;
            text-align: center;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            opacity: 0;
            transform: translateY(30px) scale(0.9);
            animation: fadeInUp 0.6s ease-out forwards;
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .grid-item:nth-child(1) { animation-delay: 0.1s; }
        .grid-item:nth-child(2) { animation-delay: 0.2s; }
        .grid-item:nth-child(3) { animation-delay: 0.3s; }
        .grid-item:nth-child(4) { animation-delay: 0.4s; }
        .grid-item:nth-child(5) { animation-delay: 0.5s; }
        .grid-item:nth-child(6) { animation-delay: 0.6s; }
        .grid-item:nth-child(7) { animation-delay: 0.7s; }
        .grid-item:nth-child(8) { animation-delay: 0.8s; }

        .grid-item:hover { transform: translateY(-3px); box-shadow: 0 5px 10px rgba(255, 255, 255, 0.1); }

        .grid-item img {

            width: 100%; max-width: 100%; height: auto; display: block; margin: 0 auto;

            transition: transform 0.5s ease-in-out; transform-origin: center center; cursor: pointer;

            object-fit: cover; flex-grow: 1;

        }

        .grid-item .design-number { /* Unused, kept for potential future use */

            color: #E10B0A; font-size: 0.8em; font-weight: bold; margin: 0 2px 5px 2px;

            word-wrap: break-word; opacity: 0; transform: translateY(10px);

            transition: opacity 0.3s ease-out 0.1s, transform 0.3s ease-out 0.1s;

        }

        .grid-item:hover .design-number { opacity: 1; transform: translateY(0); }



        /* --- Style for Grid Item "Choose This Design" Button --- */

        .choose-design-grid-btn {

            background-color: red; color: white; font-size: 0.8em; padding: 6px 10px;

            margin: 8px auto 5px auto; border-radius: 4px; width: calc(100% - 16px);

            box-sizing: border-box; opacity: 0; transform: translateY(10px);

            transition: opacity 0.3s ease-out 0.1s, transform 0.3s ease-out 0.1s, background-color 0.2s ease;

            text-transform: none;

        }

        .grid-item:hover .choose-design-grid-btn { opacity: 1; transform: translateY(0); }

        .choose-design-grid-btn:hover { background-color: #cc0000; opacity: 1; }





        /* --- Loading/Error Messages (Unchanged) --- */

        #loading-message {
            margin-top: 20px;
            text-align: center;
            color: #ccc;
            font-size: 1.1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            opacity: 0;
            animation: fadeIn 0.3s ease-out forwards;
        }

        #loading-message::before {
            content: '';
            width: 20px;
            height: 20px;
            border: 2px solid #333;
            border-top: 2px solid #dc3545;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        #error-message {
            margin-top: 15px;
            font-style: italic;
            color: #ff6b6b;
            text-align: center;
            padding: 15px;
            background: rgba(255, 107, 107, 0.1);
            border-radius: 8px;
            border-left: 4px solid #ff6b6b;
        }

        #error-message { color: red; font-weight: bold; }



        /* --- Media Queries --- */

        @media (max-width: 1199.98px) {

            #image-container { grid-template-columns: repeat(3, 1fr); gap: 12px; }

            #selectionContainer > div { flex-basis: calc(25% - 12px); }

        }

        @media (max-width: 991.98px) {

            #image-container { grid-template-columns: repeat(3, 1fr); gap: 10px; width: 98%; }

             #selectionContainer { max-width: 600px; }

             #selectionContainer > div { flex-basis: calc(50% - 10px); min-width: 150px; }

        }

        @media (max-width: 767.98px) {

             #image-container { grid-template-columns: repeat(2, 1fr); gap: 8px; width: 95%; }

             #selectionContainer { max-width: 500px; }

             #selectionContainer > div { flex-basis: calc(50% - 10px); }

             select { padding: 8px; font-size: 0.9em; }

             .choose-design-grid-btn { font-size: 0.75em; padding: 5px 8px; }

        }

        @media (max-width: 575.98px) {

            h1 { font-size: 1.5em; } h2 { font-size: 1.2em; }

            #image-container { grid-template-columns: repeat(1, 1fr); gap: 10px; width: 90%; max-width: 350px; }

            #selectionContainer { max-width: 300px; }

            #selectionContainer > div { flex-basis: 100%; min-width: unset; }

            select { font-size: 0.9em; }

            button { padding: 10px 20px; font-size: 0.9em; }

            .choose-design-grid-btn { font-size: 0.8em; padding: 6px 10px; }

			body { padding-bottom: 60px; }

        }



        /* --- Modal Styles --- MODIFIED --- */

        .modal-overlay { display: none; position: fixed; z-index: 1055; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0, 0, 0, 0.85); justify-content: center; align-items: center; padding: 15px; box-sizing: border-box; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0s linear 0.3s; }

        .modal-active { display: flex; opacity: 1; visibility: visible; transition: opacity 0.3s ease; }

        .modal-content { position: relative; background-color: #1f1f1f; margin: auto; padding: 20px; border: 1px solid #444; border-radius: 5px; width: auto; max-width: 90%; max-height: 85vh; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5); display: flex; flex-direction: column; justify-content: center; align-items: center; }

        .modal-image { /* MODIFIED for clickability */

            display: block; max-width: 100%; max-height: calc(85vh - 100px);

            height: auto; width: auto; border-radius: 3px; margin-bottom: 15px;

            cursor: pointer; /* Indicate it's clickable */
}

.modal-close {
    position: absolute;
    top: 0px;
    right: 10px;
    color: #aaa;
    font-size: 35px;
    font-weight: bold;
    line-height: 1;
    cursor: pointer;
    transition: color 0.3s ease;
    z-index: 10;
    padding: 5px;
}

.modal-close:hover, .modal-close:focus {
    color: #fff;
    text-decoration: none;
}



        /* --- Style for Modal "Choose This Design" Button --- */

#modalChooseDesignButton {
    background-color: red;
    color: white;
    font-size: 0.9em;
    padding: 10px 20px;
    margin-top: 10px;
    border-radius: 5px;
    border: none;
    cursor: pointer;
}

#modalChooseDesignButton:hover {
    background-color: #cc0000;
    opacity: 1;
}



    </style>







      <!-- Progress Bar -->

    <div id="progressBarContainer" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">

      <div id="progressBar" style="width: 0%;"></div>

      <span id="progressText">0% Complete</span>

  </div>



  <!-- Contact Form Container -->

  <div id="contactFormContainer">

      <span class="form-close-button" id="formCloseButton" title="Close and Go Back">×</span>

      <h2>Confirm Your Details</h2>

      

       <div id="selectedCarDetails">

            <h3>Your Selection</h3>

            <div><label for="displayYear">Year:</label><input type="text" id="displayYear" readonly=""></div>

            <div><label for="displayMake">Make:</label><input type="text" id="displayMake" readonly=""></div>

            <div><label for="displayModel">Model:</label><input type="text" id="displayModel" readonly=""></div>

            <div><label for="displayTrim">Trim:</label><input type="text" id="displayTrim" readonly=""></div>

       </div>

       

       <!-- Product Action Buttons -->

       <div id="productActionButtons" class="hidden">

           <button id="buyNowButton" class="action-btn primary-action">Buy Now</button>

           <button id="requestInstallationButton" class="action-btn request-installation">Request Installation</button>

           <button id="getConsultationButton" class="action-btn get-consultation">Get Consultation</button>

       </div>

       

       <!-- Contact Details Section (hidden initially) -->

       <div id="contactDetailsSection" class="hidden">

           <form id="contactForm">

               <div><label for="fullName">Full Name:</label><input type="text" id="fullName" name="fullName" required=""></div>

               <div><label for="phoneNumber">Phone Number:</label><input type="tel" id="phoneNumber" name="phoneNumber" required=""></div>

               <div><label for="emailAddress">Email Address:</label><input type="email" id="emailAddress" name="emailAddress" required=""></div>

              <div><label for="zipCode">Postal / ZIP Code:</label> <input type="text" id="zipCode" name="zipCode" pattern="[A-Za-z0-9\s\-]{3,10}" title="Please enter a valid Postal or ZIP code" required=""></div>

               <div>

                   <label for="additionalMessage">Additional Messages (Optional - Chosen Design # will appear here):</label>

                   <textarea id="additionalMessage" name="additionalMessage"></textarea>

               </div>

               <div class="terms-container">

                   <input type="checkbox" id="termsCheckbox" name="termsCheckbox" required="">

                   <label for="termsCheckbox">

                       I agree to <a href="https://emupholsterytechnology.com/terms-conditions" target="_blank" title="Opens Terms and Conditions in a new tab">Terms and Conditions</a> and <a href="https://emupholsterytechnology.com/privacy-policy" target="_blank" title="Opens Privacy Policy in a new tab">Privacy Policy</a> provided by the company. By providing my phone number, I agree to receive promotional messages from the business.

                   </label>

                   <div id="termsError">Please agree to the terms to submit.</div>

               </div>

               <div class="form-buttons"><button type="submit" id="submitButton">Submit Request</button></div>

           </form>

       </div>

  </div>



  <div id="selectionContainer">

      <div>

        <select id="years">

          <option value="">--Select Year--</option>

          <option value="2025">2025</option>

          <option value="2024">2024</option>

          <option value="2023">2023</option>

          <option value="2022">2022</option>

          <option value="2021">2021</option>

          <option value="2020">2020</option>

          <option value="2019">2019</option>

          <option value="2018">2018</option>

          <option value="2017">2017</option>

          <option value="2016">2016</option>

          <option value="2015">2015</option>

          <option value="2014">2014</option>

          <option value="2013">2013</option>

          <option value="2012">2012</option>

          <option value="2011">2011</option>

          <option value="2010">2010</option>

          <option value="2009">2009</option>

          <option value="2008">2008</option>

          <option value="2007">2007</option>

          <option value="2006">2006</option>

          <option value="2005">2005</option>

          <option value="2004">2004</option>

          <option value="2003">2003</option>

          <option value="2002">2002</option>

          <option value="2001">2001</option>

          <option value="2000">2000</option>

          <option value="1999">1999</option>

          <option value="1998">1998</option>

          <option value="1997">1997</option>

          <option value="1996">1996</option>

          <option value="1995">1995</option>

          <option value="1994">1994</option>

          <option value="1993">1993</option>

          <option value="1992">1992</option>

          <option value="1991">1991</option>

          <option value="1990">1990</option>

          <option value="1989">1989</option>

          <option value="1988">1988</option>

          <option value="1987">1987</option>

          <option value="1986">1986</option>

          <option value="1985">1985</option>

          <option value="1984">1984</option>

          <option value="1958">1958</option>

          <option value="DON'T SEE MY OPTION">DON'T SEE MY OPTION</option>

        </select>

      </div>

      <div><select id="makers" class="hidden"> <option value="">--Select Make--</option> </select></div>

      <div><select id="models" class="hidden"> <option value="">--Select Model--</option> </select></div>

      <div><select id="trims" class="hidden"><option value="default">--Select Trim--</option></select></div>

          </div>

  <div id="primaryActionButtonsContainer">

      <button id="nextButton" class="hidden">Next Step</button>

  </div>



  <div id="postSelectionButtonsContainer" class="hidden">

       <button type="button" id="goBackButton"> <i class="fas fa-arrow-left"></i> Go Back</button>

    </div>



  <div id="section-rQpvwWrmJ7" class="hidden">

       <div id="imageModalOverlay" class="modal-overlay">

           <div id="imageModalContent" class="modal-content">

               <span id="modalCloseButton" class="modal-close" title="Close">×</span>

               <img id="modalPopupImage" class="modal-image" src="" alt="Enlarged Design" title="Choose This Design">

               <button id="modalChooseDesignButton" data-design-number="">Choose This Design</button>

           </div>

       </div>

      <br>

      <div id="loading-message" style="display: none;">Loading items...</div>

      <div id="error-message"></div>

      <h3 id="trimHeading">Choose Your Trim</h3>

      <div id="image-container"></div>

  </div>









  <!-- Dropdown Helper Functions -->

  <script>

       function setVisibility(element, isVisible) {

           if (!element) return;

           if (element.id === 'contactFormContainer') {

               element.classList.toggle('visible', isVisible);

               // CSS handles max-height transition

           } else if (element.id === 'imageModalOverlay') {

               console.warn('Attempted to use setVisibility on modal overlay. Use open/closeModal instead.');

           }

           else {

               element.classList.toggle('hidden', !isVisible);

           }

       }



       function onSelectedYear(){

           const selectedYear = document.getElementById("years").value;

           const modelsSelect = document.getElementById("models");

           const makersSelect = document.getElementById("makers");

           window.selectedProductUrl = "";

           window.selectedTrim = '';

           window.selectedDesignNumber = '';

           makersSelect.innerHTML = '<option value="">--Select Make--</option>';

           modelsSelect.innerHTML = '<option value="">--Select Model--</option>';

           setVisibility(modelsSelect, false);

           setVisibility(document.getElementById("trims"), false); // Also hide trims when year changes



           // Use products.json data first, fallback to hardcoded data
           if (window.productMakesByYear && selectedYear && window.productMakesByYear[selectedYear]) {

               const makes = window.productMakesByYear[selectedYear];

               setVisibility(makersSelect, true);

               makes.forEach(make => {

                 const option = document.createElement("option");

                 option.value = make; option.text = make; makersSelect.appendChild(option);

               });

               const option = document.createElement("option");

               option.value = "DON'T SEE MY OPTION"; option.text = "DON'T SEE MY OPTION";

               makersSelect.appendChild(option);

           } else if (window.productMakesByYear && selectedYear && window.productMakesByYear[selectedYear]) {

               const makes = window.productMakesByYear[selectedYear];

               setVisibility(makersSelect, true);

               makes.forEach(make => {

                 const option = document.createElement("option");

                 option.value = make; option.text = make; makersSelect.appendChild(option);

               });

               const option = document.createElement("option");

               option.value = "DON'T SEE MY OPTION"; option.text = "DON'T SEE MY OPTION";

               makersSelect.appendChild(option);

           } else {

                setVisibility(makersSelect, false);

                console.warn("No make data available for year:", selectedYear);

           }

       }



       function onSelectedMake(){

           const selectedYear = document.getElementById("years").value;

           const makersSelectValue = document.getElementById("makers").value;

           const modelsSelect = document.getElementById("models");

           const trimsSelect = document.getElementById("trims");

           window.selectedProductUrl = "";

           window.selectedTrim = '';

           window.selectedDesignNumber = '';

           modelsSelect.innerHTML = '<option value="">--Select Model--</option>';

           trimsSelect.innerHTML = '<option value="default">--Select Trim--</option>'; // Reset trims

           setVisibility(trimsSelect, false); // Hide trims when make changes



           // Use products.json data first, fallback to hardcoded data
           if (window.productModelsByMakeYear && selectedYear && makersSelectValue &&
               window.productModelsByMakeYear[selectedYear] && window.productModelsByMakeYear[selectedYear][makersSelectValue]) {

               const models = window.productModelsByMakeYear[selectedYear][makersSelectValue];

               setVisibility(modelsSelect, true);

               models.forEach(model => {

                 const option = document.createElement("option");

                 option.value = model; option.text = model; modelsSelect.appendChild(option);

               });

               const option = document.createElement("option");

               option.value = "DON'T SEE MY OPTION"; option.text = "DON'T SEE MY OPTION";

               modelsSelect.appendChild(option);

           } else if (window.productModelsByMakeYear && selectedYear && makersSelectValue && window.productModelsByMakeYear[selectedYear] && window.productModelsByMakeYear[selectedYear][makersSelectValue]) {

               const models = window.productModelsByMakeYear[selectedYear][makersSelectValue];

               setVisibility(modelsSelect, true);

               models.forEach(model => {

                 const option = document.createElement("option");

                 option.value = model; option.text = model; modelsSelect.appendChild(option);

               });

               const option = document.createElement("option");

               option.value = "DON'T SEE MY OPTION"; option.text = "DON'T SEE MY OPTION";

               modelsSelect.appendChild(option);

           } else {

               setVisibility(modelsSelect, false);

               if (!window.productModelsByMakeYear && selectedYear && makersSelectValue && makersSelectValue !== "" && makersSelectValue !== "DON'T SEE MY OPTION") console.error("Products data not loaded.");

           }

       }



       function onSelectedModel(){

           const selectedYear = document.getElementById("years").value;

           const makersSelected = document.getElementById("makers").value;

           const modelsSelected = document.getElementById("models").value;

           const trimsSelect = document.getElementById("trims");

           window.selectedProductUrl = "";

           window.selectedTrim = '';

           window.selectedDesignNumber = '';

           trimsSelect.innerHTML = '<option value="default">--Select Trim--</option>'; // Reset trims



           // Use products.json data first for trims
           const availableTrims = getAvailableTrimsFromProducts(selectedYear, makersSelected, modelsSelected);

           if (availableTrims && availableTrims.length > 0) {

             setVisibility(trimsSelect, true);

             availableTrims.forEach(trim => {

               const option = document.createElement('option');

               option.value = trim; option.text = trim; trimsSelect.appendChild(option);

             });

           } else if(selectedYear && makersSelected && modelsSelected) {

             const trims = getAvailableTrimsFromProducts(selectedYear, makersSelected, modelsSelected);

             setVisibility(trimsSelect, true);

             trims.forEach(trim => {

               const option = document.createElement('option');

               option.value = trim; option.text = trim; trimsSelect.appendChild(option);

             });

             const option = document.createElement("option");

             option.value = "DON'T SEE MY OPTION"; option.text = "DON'T SEE MY OPTION";

             trimsSelect.appendChild(option);

           } else {

               setVisibility(trimsSelect, false);

                if (!window.productsData && selectedYear && makersSelected && modelsSelected && modelsSelected !== "" && modelsSelected !== "DON'T SEE MY OPTION") console.error("Products data not loaded.");

           }

       }

       function resolveProductLink(year, make, model, trim) {

           if (!window.productsData) return '';

           if (!year || !make || !model || !trim) return '';

           // Find matching product from products.json
           const matchingProduct = window.productsData.find(product => {
               const yearMatch = product.year && (product.year === year || product.year.includes(year));
               const makeMatch = product.make && product.make.toLowerCase() === make.toLowerCase();
               const modelMatch = product.model && product.model.toLowerCase() === model.toLowerCase();
               const trimMatch = product.trim && product.trim.toLowerCase() === trim.toLowerCase();
               return yearMatch && makeMatch && modelMatch && trimMatch;
           });

           return matchingProduct ? matchingProduct.url : '';

       }

   

  </script>



  <!-- Main Logic -->

  <script>

       const G_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzLUqdUHF8GoEBJsdF_g3r92XW-AiIgVW6m_Bqi1d9A8pAmzjHQHZ5kyzMY7XNorsp1QA/exec';

       const WEBHOOK_URL = 'https://services.leadconnectorhq.com/hooks/dC0ujeVga1kZlZsLqjZz/webhook-trigger/c7ddee18-6e5d-47df-bccc-7767e1f02d41';



       // Load products.json data from GitHub
       async function loadProductsData() {
           try {
               const response = await fetch('https://raw.githubusercontent.com/tekkenfreya/leatherteck-dropdown/main/products.json');
               window.productsData = await response.json();
               console.log('Products data loaded from GitHub:', window.productsData.length, 'items');
           } catch (error) {
               console.error('Failed to load products.json from GitHub:', error);
               window.productsData = [];
           }
       }

       // Functions to populate dropdowns from products.json
       function populateDropdownsFromProducts() {
           if (!window.productsData || !window.productsData.length) {
               console.warn('Products data not available for dropdown population');
               return;
           }

           const years = new Set();
           const makesByYear = {};
           const modelsByMakeYear = {};

           // Extract unique years, makes, and models from products.json
           window.productsData.forEach(product => {
               if (product.year && product.make && product.model) {
                   // Handle year ranges like "2024-2025"
                   const yearRange = product.year.split('-');
                   const startYear = parseInt(yearRange[0]);
                   const endYear = yearRange[1] ? parseInt(yearRange[1]) : startYear;

                   for (let year = startYear; year <= endYear; year++) {
                       const yearStr = year.toString();
                       years.add(yearStr);

                       if (!makesByYear[yearStr]) makesByYear[yearStr] = new Set();
                       makesByYear[yearStr].add(product.make);

                       if (!modelsByMakeYear[yearStr]) modelsByMakeYear[yearStr] = {};
                       if (!modelsByMakeYear[yearStr][product.make]) modelsByMakeYear[yearStr][product.make] = new Set();
                       modelsByMakeYear[yearStr][product.make].add(product.model);
                   }
               }
           });

           // Store the extracted data globally
           window.productYears = Array.from(years).sort((a, b) => b - a);
           window.productMakesByYear = {};
           window.productModelsByMakeYear = {};

           Object.keys(makesByYear).forEach(year => {
               window.productMakesByYear[year] = Array.from(makesByYear[year]).sort();
           });

           Object.keys(modelsByMakeYear).forEach(year => {
               window.productModelsByMakeYear[year] = {};
               Object.keys(modelsByMakeYear[year]).forEach(make => {
                   window.productModelsByMakeYear[year][make] = Array.from(modelsByMakeYear[year][make]).sort();
               });
           });

           console.log('Dropdown data extracted from products.json:', {
               years: window.productYears.length,
               makes: Object.keys(window.productMakesByYear).length,
               models: Object.keys(window.productModelsByMakeYear).length
           });
       }

       function getAvailableTrimsFromProducts(year, make, model) {
           if (!window.productsData) return [];

           return window.productsData
               .filter(product => {
                   if (!product.year || !product.make || !product.model || !product.trim) return false;

                   const yearMatch = product.year.includes(year) || year.toString().includes(product.year.split('-')[0]);
                   const makeMatch = product.make.toLowerCase() === make.toLowerCase();
                   const modelMatch = product.model.toLowerCase() === model.toLowerCase();

                   return yearMatch && makeMatch && modelMatch;
               })
               .map(product => product.trim)
               .filter((trim, index, array) => array.indexOf(trim) === index); // Remove duplicates
       }

       document.addEventListener('DOMContentLoaded', function() {
           // Load products data first, then populate dropdowns
           loadProductsData().then(() => {
               populateDropdownsFromProducts();
               // Populate year dropdown after data is loaded
               populateYearDropdown();
           });

           // Also ensure the productsData variable is set for other functions
           fetchProductsData().then(data => {
               window.productsData = data;
           });

           const yearSelect = document.getElementById('years');

           const makersSelect = document.getElementById('makers');

           const modelsSelect = document.getElementById('models');

           const trimsSelect = document.getElementById('trims');

           const nextButton = document.getElementById('nextButton');

           // New button variables

           const buyNowButton = document.getElementById('buyNowButton');

           const requestInstallationButton = document.getElementById('requestInstallationButton');

           const getConsultationButton = document.getElementById('getConsultationButton');

           const productActionButtons = document.getElementById('productActionButtons');

           const contactDetailsSection = document.getElementById('contactDetailsSection');

           const primaryActionButtonsContainer = document.getElementById('primaryActionButtonsContainer');

           const selectionContainer = document.getElementById('selectionContainer');

           const contactFormContainer = document.getElementById('contactFormContainer');

           const formCloseButton = document.getElementById('formCloseButton');

           const contactForm = document.getElementById('contactForm');

           const displayYear = document.getElementById('displayYear');

           const displayMake = document.getElementById('displayMake');

           const displayModel = document.getElementById('displayModel');

           const displayTrim = document.getElementById('displayTrim');

           const fullNameInput = document.getElementById('fullName');

           const phoneInput = document.getElementById('phoneNumber');

           const emailInput = document.getElementById('emailAddress');

           const zipCodeInput = document.getElementById('zipCode');

           const messageInput = document.getElementById('additionalMessage');

           const submitButton = document.getElementById('submitButton');

           const postSelectionButtonsContainer = document.getElementById('postSelectionButtonsContainer');

           const goBackButton = document.getElementById('goBackButton');

           const contactUsButton = document.getElementById('contactUsButton');

           const targetSection = document.getElementById('section-rQpvwWrmJ7');

           const imageContainer = document.getElementById('image-container');

           const loadingMessage = document.getElementById('loading-message');

           const errorMessage = document.getElementById('error-message');

           const progressBarContainer = document.getElementById('progressBarContainer');

           const progressBar = document.getElementById('progressBar');

           const progressText = document.getElementById('progressText');

           const modalOverlay = document.getElementById('imageModalOverlay');

           const modalImage = document.getElementById('modalPopupImage');

           const modalClose = document.getElementById('modalCloseButton');

           const modalChooseDesignButton = document.getElementById('modalChooseDesignButton');

          window.selectedProductUrl = window.selectedProductUrl || '';
          window.selectedTrim = window.selectedTrim || '';
          window.selectedDesignNumber = window.selectedDesignNumber || '';
          function normalizeDesignToken(value) {
              return (value || '').toString().replace(/design\s*#/i, '').trim().replace(/\s+/g, ' ').toUpperCase();
          }
          
          function buildDesignTokens(designNumber) {
              const base = normalizeDesignToken(designNumber);
              if (!base) return new Set();
              const compact = base.replace(/\s+/g, '');
              const tokens = new Set();
              const add = (val) => { if (val) tokens.add(val); };
              add(base);
              add(compact);
              add(`CUSTOM DESIGN ${base}`);
              add(`CUSTOM DESIGN ${compact}`);
              add(`FACTORY DESIGN ${base}`);
              add(`FACTORY DESIGN ${compact}`);
              add(base.replace(/^DESIGN\s+/i, ''));
              add(base.replace(/^CUSTOM\s+DESIGN\s+/i, ''));
              add(base.replace(/^FACTORY\s+DESIGN\s+/i, ''));
              return tokens;
          }
          
          function buildTrimTokens(trim) {
              const normalized = (trim || '').toString().replace(/\s+/g, ' ').trim().toUpperCase();
              if (!normalized) return [];
              const compact = normalized.replace(/\s+/g, '');
              const customRemoved = normalized.replace(/^CUSTOM\s+DESIGN\s+/i, '').trim();
              const factoryRemoved = normalized.replace(/^FACTORY\s+DESIGN\s+/i, '').trim();
              const tokens = new Set([
                  normalized,
                  compact,
                  customRemoved.toUpperCase(),
                  factoryRemoved.toUpperCase(),
                  customRemoved.replace(/\s+/g, ''),
                  factoryRemoved.replace(/\s+/g, '')
              ]);
              return Array.from(tokens).filter(Boolean);
          }
          
          function findTrimForDesign(year, make, model, designNumber) {
              if (!year || !make || !model || !designNumber) return '';
              const trims = getAvailableTrimsFromProducts(year, make, model);
              if (!trims.length) return '';
              const designTokens = buildDesignTokens(designNumber);
              for (const trim of trims) {
                  const trimTokens = buildTrimTokens(trim);
                  if (trimTokens.some(token => designTokens.has(token))) {
                      return trim;
                  }
              }
              return '';
          }
          
          function applyDesignSelection(designNumber) {
              const year = yearSelect.value;
              const make = makersSelect.value;
              const model = modelsSelect.value;
              const currentTrimValue = trimsSelect.value || '';

              if (!year || !make || !model) {
                  window.selectedTrim = currentTrimValue || '';
                  window.selectedProductUrl = resolveProductLink(year, make, model, currentTrimValue) || '';
                  return;
              }

              // Find matching trim for the design from products.json
              const matchedTrim = designNumber ? findTrimForDesignFromProducts(year, make, model, designNumber) : '';
              const effectiveTrim = matchedTrim || currentTrimValue;

              if (matchedTrim) {
                  trimsSelect.value = matchedTrim;
              }

              window.selectedTrim = effectiveTrim || '';
              window.selectedDesignNumber = designNumber || '';

              // Get URL from products.json based on selection
              window.selectedProductUrl = getProductUrlFromJson(year, make, model, effectiveTrim, designNumber) || '';

              // Update form display fields
              updateFormDisplayFields(year, make, model, effectiveTrim);
          }

          function findTrimForDesignFromProducts(year, make, model, designNumber) {
              if (!window.productsData || !designNumber) return '';

              // Try both Custom Design and Factory Design patterns
              const designPatterns = [
                  `Custom Design K${designNumber}`,
                  `Factory Design F${designNumber}`,
                  `K${designNumber}`,
                  `F${designNumber}`
              ];

              for (const product of window.productsData) {
                  if (product.year && product.make && product.model && product.trim) {
                      const yearMatch = isYearMatch(product.year, year);
                      const makeMatch = product.make.toLowerCase() === make.toLowerCase();
                      const modelMatch = product.model.toLowerCase() === model.toLowerCase();

                      if (yearMatch && makeMatch && modelMatch) {
                          // Check if any design pattern matches the trim
                          for (const pattern of designPatterns) {
                              if (product.trim.includes(pattern)) {
                                  return product.trim;
                              }
                          }
                      }
                  }
              }
              return '';
          }

          function getProductUrlFromJson(year, make, model, trim, designNumber) {
              if (!window.productsData) return '';

              // First try exact trim match
              if (trim) {
                  for (const product of window.productsData) {
                      if (product.year && product.make && product.model && product.trim && product.url) {
                          const yearMatch = isYearMatch(product.year, year);
                          const makeMatch = product.make.toLowerCase() === make.toLowerCase();
                          const modelMatch = product.model.toLowerCase() === model.toLowerCase();
                          const trimMatch = product.trim.toLowerCase() === trim.toLowerCase();

                          if (yearMatch && makeMatch && modelMatch && trimMatch) {
                              return product.url;
                          }
                      }
                  }
              }

              // If no exact trim match and we have a design number, try design-based matching
              if (designNumber) {
                  const matchedTrim = findTrimForDesignFromProducts(year, make, model, designNumber);
                  if (matchedTrim) {
                      return getProductUrlFromJson(year, make, model, matchedTrim);
                  }
              }

              return resolveProductLink(year, make, model, trim) || '';
          }

          function isYearMatch(productYear, selectedYear) {
              if (!productYear || !selectedYear) return false;

              // Handle year ranges like "2024-2025"
              if (productYear.includes('-')) {
                  const [startYear, endYear] = productYear.split('-').map(y => parseInt(y));
                  const year = parseInt(selectedYear);
                  return year >= startYear && year <= endYear;
              }

              // Handle single year
              return productYear === selectedYear.toString();
          }

          function updateFormDisplayFields(year, make, model, trim) {
              if (document.getElementById('displayYear')) {
                  document.getElementById('displayYear').value = year || '';
              }
              if (document.getElementById('displayMake')) {
                  document.getElementById('displayMake').value = make || '';
              }
              if (document.getElementById('displayModel')) {
                  document.getElementById('displayModel').value = model || '';
              }
              if (document.getElementById('displayTrim')) {
                  document.getElementById('displayTrim').value = trim || '';
              }
          }

          // Function to populate year dropdown (called after data is loaded)
          function populateYearDropdown() {
              const yearSelect = document.getElementById('years');
              if (!yearSelect) return;

              if (window.productYears && window.productYears.length > 0) {
                  const availableYears = window.productYears;
                  yearSelect.innerHTML = '<option value="">--Select Year--</option>';

                  availableYears.forEach(year => {
                      const option = document.createElement('option');
                      option.value = year;
                      option.text = year;
                      yearSelect.appendChild(option);
                  });

                  const yearOption = document.createElement('option');
                  yearOption.value = "DON'T SEE MY OPTION";
                  yearOption.text = "DON'T SEE MY OPTION";
                  yearSelect.appendChild(yearOption);

                  console.log('Year dropdown populated with', availableYears.length, 'years');
              } else {
                  console.error("Products data not loaded. Cannot populate year dropdown.");
                  yearSelect.innerHTML = '<option value="">--Select Year--</option><option value="DON\'T SEE MY OPTION">DON\'T SEE MY OPTION</option>';
              }
          }



           function updateProgress() {

              let progress = 0;
              let text = "0% Complete";

              const yearValue = yearSelect.value;
              const makerValue = makersSelect.value;
              const modelValue = modelsSelect.value;
              const trimValue = trimsSelect.value;

              const yearValid = yearValue && yearValue !== "" && yearValue !== "DON'T SEE MY OPTION";
              const makeValid = !makersSelect.classList.contains('hidden') && makerValue && makerValue !== "" && makerValue !== "DON'T SEE MY OPTION";
              const modelValid = !modelsSelect.classList.contains('hidden') && modelValue && modelValue !== "" && modelValue !== "DON'T SEE MY OPTION";
              const trimValid = !trimsSelect.classList.contains('hidden') && trimValue && trimValue !== "" && trimValue !== "default" && trimValue !== "DON'T SEE MY OPTION";

              const formIsVisible = contactFormContainer.classList.contains('visible');
              const postSelectionAreaVisible = !postSelectionButtonsContainer.classList.contains('hidden') || !targetSection.classList.contains('hidden');

              if (formIsVisible || postSelectionAreaVisible) {
                  progress = 100;
                  text = window.selectedProductUrl ? "Selection Complete" : "Choose Design";
              } else {
                  if (yearValid) { progress = 25; text = "25% Complete"; }
                  if (makeValid) { progress = 50; text = "50% Complete"; }
                  if (modelValid) { progress = 75; text = "75% Complete"; }
                  if (trimValid) { progress = 100; text = "100% Complete"; }
              }

              if (window.selectedProductUrl) {
                  progress = 100;
                  text = "100% Complete";
              }

              progressBar.style.width = `${progress}%`;
              progressBarContainer.setAttribute('aria-valuenow', progress);
              progressText.textContent = text;

          }


          function updatePrimaryActionButtonsVisibility() {

              const yearValue = yearSelect.value;

              const makerValue = makersSelect.value;

              const modelValue = modelsSelect.value;

              const trimValue = trimsSelect.value;

              const formIsVisible = contactFormContainer.classList.contains('visible');

              const imageGridIsVisible = !targetSection.classList.contains('hidden');

              if (formIsVisible || imageGridIsVisible) {

                  setVisibility(nextButton, false);

                  primaryActionButtonsContainer.classList.add('hidden-container');

                  return;

              }

              primaryActionButtonsContainer.classList.remove('hidden-container');

              const yearValid = yearValue && yearValue !== "" && yearValue !== "DON'T SEE MY OPTION";

              const makeValid = !makersSelect.classList.contains('hidden') && makerValue && makerValue !== "" && makerValue !== "DON'T SEE MY OPTION";

              const modelValid = !modelsSelect.classList.contains('hidden') && modelValue && modelValue !== "" && modelValue !== "DON'T SEE MY OPTION";

              const trimValid = !trimsSelect.classList.contains('hidden') && trimValue && trimValue !== "" && trimValue !== "default" && trimValue !== "DON'T SEE MY OPTION";

              const canProceedToNextStep = yearValid && makeValid && modelValid && trimValid;

              setVisibility(nextButton, canProceedToNextStep);

          }

// --- MODIFIED FUNCTION ---

                                                           function showContactFormDirectly(designNumber = null) {

              let finalYear = yearSelect.value;
              let finalMake = makersSelect.value;
              let finalModel = modelsSelect.value;
              let finalTrim = window.selectedTrim || trimsSelect.value || "";

              if (finalYear === "DON'T SEE MY OPTION" || finalYear === "") {
                  displayYear.value = "Not Listed/Specified";
                  displayMake.value = "Not Listed/Specified";
                  displayModel.value = "Not Listed/Specified";
                  displayTrim.value = "Not Listed/Specified";
                  finalYear = "";
                  finalMake = "";
                  finalModel = "";
                  finalTrim = "";
              } else {
                  displayYear.value = finalYear;
                  if (finalMake === "DON'T SEE MY OPTION" || finalMake === "" || makersSelect.classList.contains("hidden")) {
                      displayMake.value = "Not Listed/Specified";
                      displayModel.value = "Not Listed/Specified";
                      displayTrim.value = "Not Listed/Specified";
                      finalMake = "";
                      finalModel = "";
                      finalTrim = "";
                  } else {
                      displayMake.value = finalMake;
                      if (finalModel === "DON'T SEE MY OPTION" || finalModel === "" || modelsSelect.classList.contains("hidden")) {
                          displayModel.value = "Not Listed/Specified";
                          displayTrim.value = "Not Listed/Specified";
                          finalModel = "";
                          finalTrim = "";
                      } else {
                          displayModel.value = finalModel;
                          const trimValid = finalTrim && finalTrim !== "DON'T SEE MY OPTION" && finalTrim !== "default";
                          if (trimValid) {
                              displayTrim.value = finalTrim;
                          } else {
                              displayTrim.value = "Not Listed/Specified";
                              finalTrim = "";
                          }
                      }
                  }
              }

              messageInput.value = "";

              if (designNumber) {
                  messageInput.value = "Chosen Design #: " + designNumber + "\n";
                  window.selectedDesignNumber = designNumber;
              }

              window.selectedTrim = finalTrim || "";

              const resolvedProduct = (finalYear && finalMake && finalModel && finalTrim)
                  ? resolveProductLink(finalYear, finalMake, finalModel, finalTrim)
                  : "";

              window.selectedProductUrl = resolvedProduct || "";

              setVisibility(selectionContainer, false);
              setVisibility(targetSection, false); // Hide image grid
              setVisibility(postSelectionButtonsContainer, true);
              setVisibility(goBackButton, true);
              setVisibility(contactFormContainer, true);
              setVisibility(productActionButtons, true);
              setVisibility(contactDetailsSection, false);

              updatePrimaryActionButtonsVisibility();
              updateProgress();
              contactFormContainer.scrollIntoView({ behavior: "smooth" });
          }

          // --- END OF MODIFIED FUNCTION ---





           function handleGoBack() {

              setVisibility(contactFormContainer, false);

              setVisibility(postSelectionButtonsContainer, false);

              setVisibility(targetSection, false);

              setVisibility(selectionContainer, true);

              setVisibility(productActionButtons, false);

              setVisibility(contactDetailsSection, false);



              contactForm.reset();

              const termsError = document.getElementById('termsError');

              if(termsError) termsError.style.display = 'none';

              if (submitButton) {

                  submitButton.disabled = false; submitButton.textContent = 'Submit Request';

              }

              messageInput.value = '';



              if (yearSelect.value && yearSelect.value !== "" && yearSelect.value !== "DON'T SEE MY OPTION") {

                  onSelectedYear();

                  if (makersSelect.value && makersSelect.value !== "" && makersSelect.value !== "DON'T SEE MY OPTION") {

                      onSelectedMake();

                      if (modelsSelect.value && modelsSelect.value !== "" && modelsSelect.value !== "DON'T SEE MY OPTION") {

                          onSelectedModel();

                      } else {

                           setVisibility(trimsSelect, false);

                      }

                  } else {

                      setVisibility(modelsSelect, false);

                      setVisibility(trimsSelect, false);

                  }

              } else {

                  setVisibility(makersSelect, false);

                  setVisibility(modelsSelect, false);

                  setVisibility(trimsSelect, false);

              }



              window.selectedProductUrl = resolveProductLink(yearSelect.value, makersSelect.value, modelsSelect.value, trimsSelect.value);

              updatePrimaryActionButtonsVisibility();

              updateProgress();

              selectionContainer.scrollIntoView({ behavior: 'smooth' });

          }



           yearSelect.addEventListener('change', () => {

               if (yearSelect.value === "DON'T SEE MY OPTION") { showContactFormDirectly(); return; }

               onSelectedYear();

               setVisibility(postSelectionButtonsContainer, false); setVisibility(targetSection, false);

               updatePrimaryActionButtonsVisibility(); updateProgress();

           });

           makersSelect.addEventListener('change', () => {

              if (makersSelect.value === "DON'T SEE MY OPTION") { showContactFormDirectly(); return; }

               onSelectedMake();

               setVisibility(postSelectionButtonsContainer, false); setVisibility(targetSection, false);

               updatePrimaryActionButtonsVisibility(); updateProgress();

          });

           modelsSelect.addEventListener('change', () => {

              if (modelsSelect.value === "DON'T SEE MY OPTION") { showContactFormDirectly(); return; }

               onSelectedModel();

               setVisibility(postSelectionButtonsContainer, false); setVisibility(targetSection, false);

               updatePrimaryActionButtonsVisibility(); updateProgress();

          });

           trimsSelect.addEventListener('change', () => {

              if (trimsSelect.value === "DON'T SEE MY OPTION") { showContactFormDirectly(); return; }

               setVisibility(postSelectionButtonsContainer, false); setVisibility(targetSection, false);

               if (trimsSelect.value && trimsSelect.value !== "" && trimsSelect.value !== "default" && trimsSelect.value !== "DON'T SEE MY OPTION") {

                   fetchAndDisplayItems(modelsSelect.value, trimsSelect.value);

               } else { imageContainer.innerHTML = ''; errorMessage.textContent = ''; }

               updatePrimaryActionButtonsVisibility(); updateProgress();

          });


           nextButton.addEventListener('click', function() {

               // displayYear.value etc. will be set by showContactFormDirectly if called,

               // or if not (going to image grid), the values are read directly from selects for fetchAndDisplayItems

               messageInput.value = ''; // Clear message before showing image grid or form

               setVisibility(selectionContainer, false);

               setVisibility(contactFormContainer, false); // Ensure form is hidden if going to image grid

               setVisibility(postSelectionButtonsContainer, true);

               setVisibility(goBackButton, true);

               // contactUsButton removed - no longer needed

               setVisibility(targetSection, true);

               // Update product URL using products.json data
               window.selectedProductUrl = getProductUrlFromJson(yearSelect.value, makersSelect.value, modelsSelect.value, trimsSelect.value) ||
                                         resolveProductLink(yearSelect.value, makersSelect.value, modelsSelect.value, trimsSelect.value);

               fetchAndDisplayItems(modelsSelect.value, trimsSelect.value);

               updatePrimaryActionButtonsVisibility();

               updateProgress();

               targetSection.scrollIntoView({ behavior: 'smooth' });

           });



          // New button event listeners

          buyNowButton.addEventListener('click', function() {

              const selectedYearValue = yearSelect.value;
              const selectedMakeValue = makersSelect.value;
              const selectedModelValue = modelsSelect.value;
              const selectedTrimValue = trimsSelect.value;

              const displayYearValue = displayYear.value || '';
              const displayMakeValue = displayMake.value || '';
              const displayModelValue = displayModel.value || '';
              const displayTrimValue = displayTrim.value || '';

              const designNumber = window.selectedDesignNumber || '';

              let destinationUrl = '';

              // Priority 1: Use stored product URL from design selection
              if (window.selectedProductUrl) {
                  destinationUrl = window.selectedProductUrl;
              }
              // Priority 2: Try to get URL from products.json with current selections
              else if (selectedYearValue && selectedMakeValue && selectedModelValue) {
                  const effectiveTrim = selectedTrimValue && selectedTrimValue !== 'default' && selectedTrimValue !== "DON'T SEE MY OPTION" ? selectedTrimValue : displayTrimValue;
                  destinationUrl = getProductUrlFromJson(selectedYearValue, selectedMakeValue, selectedModelValue, effectiveTrim, designNumber);
              }
              // Priority 3: Fallback to display values from form
              else if (displayYearValue && displayMakeValue && displayModelValue && displayTrimValue) {
                  destinationUrl = getProductUrlFromJson(displayYearValue, displayMakeValue, displayModelValue, displayTrimValue, designNumber);
              }
              // Priority 4: Use original resolveProductLink function as fallback
              if (!destinationUrl && selectedYearValue && selectedMakeValue && selectedModelValue && selectedTrimValue && selectedTrimValue !== 'default' && selectedTrimValue !== "DON'T SEE MY OPTION") {
                  destinationUrl = resolveProductLink(selectedYearValue, selectedMakeValue, selectedModelValue, selectedTrimValue);
              }

              if (!destinationUrl) {
                  destinationUrl = resolveProductLink(displayYearValue, displayMakeValue, displayModelValue, displayTrimValue);

              }

              if (!destinationUrl) {

                  destinationUrl = window.selectedProductUrl || '';

              }

              if (destinationUrl) {

                  try {

                      const url = new URL(destinationUrl);

                      url.searchParams.set('utm_source', 'website');

                      url.searchParams.set('utm_medium', 'vehicle_selector');

                      url.searchParams.set('utm_campaign', 'direct_purchase');

                      if (designNumber) {

                          url.searchParams.set('design', designNumber);

                      }

                      window.open(url.toString(), '_blank');

                  } catch (error) {

                      console.warn('Invalid product URL format, falling back to direct navigation.', destinationUrl, error);

                      window.location.href = destinationUrl;

                  }

                  return;

              }

              const params = new URLSearchParams();

              if (displayYearValue && displayYearValue !== 'Not Listed/Specified') params.append('year', displayYearValue);

              if (displayMakeValue && displayMakeValue !== 'Not Listed/Specified') params.append('make', displayMakeValue);

              if (displayModelValue && displayModelValue !== 'Not Listed/Specified') params.append('model', displayModelValue);

              if (displayTrimValue && displayTrimValue !== 'Not Listed/Specified') params.append('trim', displayTrimValue);

              if (designNumber) params.append('design', designNumber);

              params.append('source', 'vehicle_selector');

              params.append('utm_source', 'website');

              params.append('utm_medium', 'vehicle_selector');

              params.append('utm_campaign', 'direct_purchase');

              const storeUrl = '/store' + (params.toString() ? `?${params.toString()}` : '');

              window.location.href = storeUrl;

          });

          

          requestInstallationButton.addEventListener('click', function() {

              setVisibility(contactDetailsSection, true);

              contactDetailsSection.scrollIntoView({ behavior: 'smooth' });

          });

          

          getConsultationButton.addEventListener('click', function() {

              setVisibility(contactDetailsSection, true);

              contactDetailsSection.scrollIntoView({ behavior: 'smooth' });

          });



           // contactUsButton removed - no longer needed

           goBackButton.addEventListener('click', handleGoBack);

           if (formCloseButton) formCloseButton.addEventListener('click', handleGoBack);



           document.addEventListener('click', function(event) {

              const isFormVisible = contactFormContainer.classList.contains('visible');

              if (!isFormVisible) return;

              const clickedInsideForm = contactFormContainer.contains(event.target);

              const clickedSpecialButton = goBackButton.contains(event.target) || (formCloseButton && formCloseButton.contains(event.target)) || submitButton.contains(event.target) || event.target.closest('a');

              const clickedOpener = event.target.id === 'contactUsButton' || event.target.closest('.choose-design-grid-btn') || event.target.id === 'modalChooseDesignButton' || event.target.id === 'modalPopupImage';



              if (!clickedInsideForm && !clickedSpecialButton && !clickedOpener) {

                  if (event.target !== yearSelect && event.target !== makersSelect && event.target !== modelsSelect && event.target !== trimsSelect) {

                      handleGoBack();

                  }

              }

          });



           contactForm.addEventListener('submit', function(event) {

              event.preventDefault();

               const termsCheckbox = document.getElementById('termsCheckbox');

               const termsError = document.getElementById('termsError');

               termsError.style.display = 'none';



               if (!termsCheckbox.checked) {

                   termsError.style.display = 'block'; termsCheckbox.focus(); return;

               }

               const dataToSend = {

                   car_year: displayYear.value, car_make: displayMake.value, car_model: displayModel.value, car_trim: displayTrim.value,

                   full_name: fullNameInput.value, phone: phoneInput.value, email: emailInput.value, zipcode: zipCodeInput.value,  message: messageInput.value,

                   terms_agreed: termsCheckbox.checked, source: 'Website Form', tags: 'Upholstery Quote Request'

               };

    

               if (submitButton) { submitButton.textContent = 'Sending...'; submitButton.disabled = true; }

               setVisibility(goBackButton, false);



               fetch(WEBHOOK_URL, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(dataToSend) })

               .then(response => {

                   if (response.ok) {

                       setVisibility(contactFormContainer, false); setVisibility(postSelectionButtonsContainer, false);

                       targetSection.innerHTML = `<h2>Thank You!</h2><p>Your request has been submitted successfully. We will contact you shortly.</p>`;

                       setVisibility(targetSection, true); window.scrollTo({ top: 0, behavior: 'smooth' });

                       return response.text();

                   } else {

                       console.error('Webhook trigger failed! Status:', response.status, response.statusText);

                       return response.text().then(text => { throw new Error(`Webhook error: ${response.status} ${response.statusText} - ${text || 'No additional error info'}`); });

                   }

               })

               .then(data => { console.log('Webhook response (if any):', data); })

               .catch(error => {

                   console.error('Error sending data to webhook:', error);

                   alert(`There was an error submitting your request: ${error.message}. Please try again or contact us directly.`);

                   if (submitButton) { submitButton.textContent = 'Submit Request'; submitButton.disabled = false; }

                   setVisibility(goBackButton, true);

               });

          });



           // Global variable to store products data
           var productsData = null;

           // Function to fetch products.json data from GitHub (Production)
           async function fetchProductsData() {
               if (productsData) return productsData; // Return cached data if already loaded

               try {
                   // Using GitHub raw URL for production
                   const response = await fetch('https://raw.githubusercontent.com/tekkenfreya/leatherteck-dropdown/main/products.json');
                   if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                   productsData = await response.json();
                   console.log('Successfully loaded products.json from GitHub');
                   return productsData;
               } catch (error) {
                   console.error('Error fetching products.json from GitHub:', error);
                   // Show user-friendly error message
                   const errorMessage = 'Unable to load product data. Please refresh the page or contact support.';
                   alert(errorMessage);
                   return [];
               }
           }

           // Function to get designs for a specific vehicle from products.json
           function getDesignsForVehicle(year, make, model) {
               if (!productsData) return [];

               return productsData.filter(product => {
                   // Match year (handle ranges like "2024-2025" or "2018 - 2022")
                   if (product.year && year) {
                       const yearStr = product.year.trim().replace(/\s+/g, ''); // Clean spaces
                       if (yearStr.includes('-')) {
                           // Handle year range
                           const parts = yearStr.split('-');
                           if (parts.length === 2) {
                               const startYear = parseInt(parts[0]);
                               const endYear = parseInt(parts[1]);
                               const selectedYear = parseInt(year);
                               // Check if selected year falls within the range (inclusive)
                               if (selectedYear < startYear || selectedYear > endYear) {
                                   return false;
                               }
                           }
                       } else if (product.year !== year) {
                           // Exact year match
                           return false;
                       }
                   }

                   // Match make and model (case insensitive)
                   if (product.make && make && product.make.toLowerCase() !== make.toLowerCase()) return false;
                   if (product.model && model && product.model.toLowerCase() !== model.toLowerCase()) return false;

                   return true;
               });
           }

           async function fetchAndDisplayItems(brand, selectedTrim = null) {

               if (!brand || brand === "" || brand === "DON'T SEE MY OPTION") {
                    imageContainer.innerHTML = ''; errorMessage.textContent = ''; loadingMessage.style.display = 'none'; return;
                }

               imageContainer.innerHTML = ''; errorMessage.textContent = ''; loadingMessage.style.display = 'block';

               try {
                   // Fetch products data if not already loaded
                   productsData = await fetchProductsData();

                   // Get current selections
                   const year = yearSelect.value;
                   const make = makersSelect.value;
                   const model = modelsSelect.value;
                   const trim = selectedTrim || trimsSelect.value;

                   // Get designs for this vehicle
                   let vehicleProducts = getDesignsForVehicle(year, make, model);

                   // Filter by trim if specified
                   if (trim && trim !== "" && trim !== "default" && trim !== "DON'T SEE MY OPTION") {
                       vehicleProducts = vehicleProducts.filter(product => {
                           return product.trim && product.trim.toLowerCase() === trim.toLowerCase();
                       });
                   }

                   if (vehicleProducts.length === 0) {
                       errorMessage.innerHTML = `No design examples currently available for "${brand}". You can still request a quote by clicking the "Get Quote Now!" button.`;
                   } else {
                       // Group by design to avoid duplicates
                       const designMap = new Map();

                       vehicleProducts.forEach(product => {
                           // Use designNumber from products.json if available
                           const designNumber = product.designNumber || 'N/A';
                           const trimName = product.trim || '';

                           // Use designNumber as unique key to avoid duplicates
                           const key = `${designNumber}|${product.image || ''}`;

                           if (!designMap.has(key)) {
                               designMap.set(key, {
                                   designNumber: designNumber,
                                   trimName: trimName,
                                   image: product.image,
                                   url: product.url,
                                   name: product.name || trimName
                               });
                           }
                       });

                       const uniqueItems = Array.from(designMap.values());

                       // Sort designs numerically (1, 2, 3... instead of 1, 10, 11, 2, 20...)
                       uniqueItems.sort((a, b) => {
                           const numA = parseInt(a.designNumber) || 999;
                           const numB = parseInt(b.designNumber) || 999;
                           return numA - numB;
                       });

                       uniqueItems.forEach(item => {
                           const itemDiv = document.createElement('div'); itemDiv.classList.add('grid-item');

                           const img = document.createElement('img');
                           img.src = item.image || '';
                           img.alt = `${brand} - ${item.trimName || 'Design'}`;
                           img.dataset.designNumber = item.designNumber || 'No Design #';
                           img.dataset.trimName = item.trimName || '';

                           img.onerror = () => {
                               console.warn(`Failed to load image: ${item.image}`);
                               img.alt = `Failed to load: ${item.designNumber || 'N/A'}`;
                           };

                           const chooseButton = document.createElement('button');
                           chooseButton.classList.add('choose-design-grid-btn');

                           // Create button text with design number
                           const designNumber = item.designNumber || 'No Design #';
                           chooseButton.textContent = `Choose Design #${designNumber}`;
                           chooseButton.dataset.designNumber = designNumber;
                           chooseButton.dataset.trimName = item.trimName || '';

                           itemDiv.appendChild(img);
                           itemDiv.appendChild(chooseButton);
                           imageContainer.appendChild(itemDiv);
                       });
                   }

               } catch (error) {
                   console.error('Error fetching/displaying items:', error);
                   errorMessage.textContent = `Error loading designs: ${error.message}. Please try again later.`;
               } finally {
                   loadingMessage.style.display = 'none';
               }

           }



           function handleChooseDesign(designNumber, trimName = null) {

              applyDesignSelection(designNumber);

              // Store the trim name from the selected product
              if (trimName) {
                  window.selectedTrim = trimName;
              }

              showContactFormDirectly(designNumber);

              if (modalOverlay.classList.contains('modal-active')) {

                  closeModal();

              }

           }



           function openModal(imageUrl, designNumberText, trimNameText) {

               if (!modalOverlay || !modalImage || !modalChooseDesignButton) return;

               modalImage.src = imageUrl;

               modalChooseDesignButton.dataset.designNumber = designNumberText;
               modalChooseDesignButton.dataset.trimName = trimNameText || '';

               // Use trim name if available, otherwise fall back to design number
               const displayText = trimNameText && trimNameText !== 'No Design #' ?
                   `Choose ${trimNameText}` :
                   `Choose Design #${designNumberText}`;

               modalChooseDesignButton.textContent = displayText;

               modalOverlay.classList.add('modal-active'); document.body.style.overflow = 'hidden';

           }

           function closeModal() {

               if (!modalOverlay || !modalImage || !modalChooseDesignButton) return;

               modalOverlay.classList.remove('modal-active'); modalImage.src = '';

               modalChooseDesignButton.dataset.designNumber = '';

               modalChooseDesignButton.textContent = 'Choose This Design'; document.body.style.overflow = '';

           }



           if (imageContainer) {

               imageContainer.addEventListener('click', function(event) {

                   const imgElement = event.target.closest('img');

                   const buttonElement = event.target.closest('.choose-design-grid-btn');

                   if (buttonElement) {
                       handleChooseDesign(buttonElement.dataset.designNumber, buttonElement.dataset.trimName);
                   }

                   else if (imgElement && imgElement.closest('.grid-item')) {
                       openModal(imgElement.src, imgElement.dataset.designNumber, imgElement.dataset.trimName);
                   }

               });

           }



           if (modalImage) {

              modalImage.addEventListener('click', function() {

                  const designNum = modalChooseDesignButton.dataset.designNumber;
                  const trimName = modalChooseDesignButton.dataset.trimName;

                  if (designNum && modalOverlay.classList.contains('modal-active')) {

                      handleChooseDesign(designNum, trimName);

                  }

              });

          }



           if (modalClose) modalClose.addEventListener('click', closeModal);

           if (modalOverlay) modalOverlay.addEventListener('click', function(event) { if (event.target === modalOverlay) closeModal(); });

           document.addEventListener('keydown', function(event) { if (event.key === 'Escape' && modalOverlay && modalOverlay.classList.contains('modal-active')) closeModal(); });

           if (modalChooseDesignButton) modalChooseDesignButton.addEventListener('click', function() {
               if (this.dataset.designNumber) handleChooseDesign(this.dataset.designNumber, this.dataset.trimName);
           });



           setVisibility(makersSelect, false); setVisibility(modelsSelect, false); setVisibility(trimsSelect, false);

           setVisibility(contactFormContainer, false); setVisibility(postSelectionButtonsContainer, false); setVisibility(targetSection, false);

           updatePrimaryActionButtonsVisibility(); updateProgress();

       });

   

  </script>





</div>


</body>
</html>
